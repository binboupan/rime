
  <script>

      let playing_{{service.id}} = false;
      const player_{{service.id}} =
        new IcecastMetadataPlayer(
          "{{service.plugin_config['url']}}", // stream endpoint
          { 
            onMetadata:(metadata)=>{
                console.log(metadata)
                document.getElementById("metadata_{{service.id}}").innerHTML = metadata.StreamTitle;
                document.title = metadata.StreamTitle;
          }
        }                        
        );


      function togglePlayState_{{service.id}}()
      {
        if(playing_{{service.id}}==false) {
          player_{{service.id}}.play();
          playing_{{service.id}} = true;
          document.getElementById("playicon_{{service.id}}").innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="M16 19q-.825 0-1.412-.587T14 17V7q0-.825.588-1.412T16 5t1.413.588T18 7v10q0 .825-.587 1.413T16 19m-8 0q-.825 0-1.412-.587T6 17V7q0-.825.588-1.412T8 5t1.413.588T10 7v10q0 .825-.587 1.413T8 19"/></svg>';
        }
        else {
          player_{{service.id}}.stop();
          playing_{{service.id}} = false;

          document.getElementById("playicon_{{service.id}}").innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path fill="currentColor" d="M9 17.192V6.808L17.154 12z"/></svg>';
        }
      }
</script>
